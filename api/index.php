<?php

////////////////////////////////////////////////////////////////////////////////
define("REPORTS_DIR" , __DIR__."/../data");

////////////////////////////////////////////////////////////////////////////////
include_once 'lib/Epi.php';
Epi::setPath('base', 'lib');
Epi::init('api');
Epi::setSetting('exceptions', true);

////////////////////////////////////////////////////////////////////////////////
getApi()->get('/reports/(.*)', 'reports',EpiApi::external);
getRoute()->run();

////////////////////////////////////////////////////////////////////////////////
function reports($root)
{
  $files = @array_values(preg_grep('/^([^.])/', scandir(REPORTS_DIR."/".$root)));
  if($files === false) {
    $files = array();
  }
  return $files;
}